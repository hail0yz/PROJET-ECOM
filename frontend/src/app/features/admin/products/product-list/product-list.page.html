<admin-layout>
    <div class="h-full flex-1 flex-col gap-8 p-8 md:flex">
        <div class="flex items-center justify-between gap-2">
            <div class="flex flex-col gap-1">
                <h2 class="text-2xl font-semibold tracking-tight">Gérer vos produits</h2>
                <p class="text-muted-foreground">
                    Voici la liste de toutes les produits de produits de votre boutique.
                    Vous pouvez en ajouter, modifier ou supprimer.
                </p>
            </div>
        </div>
        <div class="flex flex-col gap-4">
            <div class="flex items-center justify-between">
                <div class="flex flex-1 items-center gap-2">
                    <input #q (keyup.enter)="onSearch(q.value)"
                        class="file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive h-8 w-[150px] lg:w-[250px]"
                        placeholder="Filtrer les produits..." />
                    <!-- <button data-slot="popover-trigger"
                        class="cursor-pointer inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 h-8 border-dashed"
                        type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-_R_9d9bsnpfjb_"
                        data-state="closed">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-circle-plus">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M8 12h8"></path>
                            <path d="M12 8v8"></path>
                        </svg>
                        Status
                    </button>
                    <button data-slot="popover-trigger"
                        class="cursor-pointer inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 h-8 border-dashed"
                        type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-_R_dd9bsnpfjb_"
                        data-state="closed">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-circle-plus">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M8 12h8"></path>
                            <path d="M12 8v8"></path>
                        </svg>
                        Priority
                    </button> -->
                </div>
                <div class="flex items-center gap-2">
                    <button
                        class="cursor-pointer inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive bg-primary text-primary-foreground shadow-xs hover:bg-primary/90 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-import-icon lucide-import">
                            Page {{ filters().page }} sur {{ pagedBooks()?.totalPages ?? 1 }}
                            <path d="m8 11 4 4 4-4" />
                            <path d="M8 5H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-4" />
                        </svg>
                        Importer produits
                    </button>
                    <button
                        class="cursor-pointer inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive bg-primary text-primary-foreground shadow-xs hover:bg-primary/90 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-plus-icon lucide-plus">
                            <path d="M5 12h14" />
                            <path d="M12 5v14" />
                        </svg>
                        Ajouter un produit
                    </button>
                </div>
            </div>
            <div class="rounded-md border border-gray-200">
                <div data-slot="table-container" class="relative w-full overflow-x-auto">
                    <table data-slot="table" class="w-full caption-bottom text-sm">
                        <thead data-slot="table-header" class="[&amp;_tr]:border-b border-gray-200">
                            <tr data-slot="table-row"
                                class="hover:bg-muted/50 data-[state=selected]:bg-muted border-b  border-gray-200 transition-colors">
                                <th data-slot="table-head"
                                    class="text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&amp;:has([role=checkbox])]:pr-0 [&amp;&gt;[role=checkbox]]:translate-y-[2px]"
                                    colspan="1">
                                    <button type="button" role="checkbox" aria-checked="false" data-state="unchecked"
                                        value="on" data-slot="checkbox"
                                        class="peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 translate-y-[2px]"
                                        aria-label="Select all">
                                    </button>
                                </th>
                                <th data-slot="table-head"
                                    class="text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&amp;:has([role=checkbox])]:pr-0 [&amp;&gt;[role=checkbox]]:translate-y-[2px]"
                                    colspan="1">
                                    <div class="flex items-center gap-2">ID</div>
                                </th>
                                <th data-slot="table-head"
                                    class="text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&amp;:has([role=checkbox])]:pr-0 [&amp;&gt;[role=checkbox]]:translate-y-[2px]"
                                    colspan="1">
                                    <div class="flex items-center gap-2">
                                        Titre
                                    </div>
                                </th>
                                <th data-slot="table-head"
                                    class="text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&amp;:has([role=checkbox])]:pr-0 [&amp;&gt;[role=checkbox]]:translate-y-[2px]"
                                    colspan="1">
                                    <div class="flex items-center gap-2">
                                        Auteur
                                    </div>
                                </th>
                                <th data-slot="table-head"
                                    class="text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&amp;:has([role=checkbox])]:pr-0 [&amp;&gt;[role=checkbox]]:translate-y-[2px]"
                                    colspan="1">
                                    <div class="flex items-center gap-2">
                                        Catégorie
                                    </div>
                                </th>
                                <th data-slot="table-head"
                                    class="text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&amp;:has([role=checkbox])]:pr-0 [&amp;&gt;[role=checkbox]]:translate-y-[2px]"
                                    colspan="1">
                                    <div class="flex items-center gap-2">
                                        Publié en
                                    </div>
                                </th>
                                <th data-slot="table-head"
                                    class="text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&amp;:has([role=checkbox])]:pr-0 [&amp;&gt;[role=checkbox]]:translate-y-[2px]"
                                    colspan="1">
                                    <div class="flex items-center gap-2">Actions</div>
                                </th>
                            </tr>
                        </thead>
                        <tbody data-slot="table-body" class="[&_tr:last-child]:border-0">
                            @if (loading()) {
                            <tr>
                                <td colspan="7" class="p-4 text-center">Chargement...</td>
                            </tr>
                            } @else {
                            @for (book of pagedBooks()?.content ?? []; track book.id) {
                            <tr
                                class="hover:bg-muted/50 data-[state=selected]:bg-muted border-b border-gray-200 transition-colors">
                                <td class="p-2 align-middle whitespace-nowrap">
                                    <button type="button" role="checkbox" aria-checked="false" data-state="unchecked"
                                        value="on" data-slot="checkbox"
                                        class="peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 translate-y-[2px]"
                                        aria-label="Select row"></button>
                                </td>
                                <td class="p-2 align-middle whitespace-nowrap">
                                    <div class="w-[80px]">#{{ book.id }}</div>
                                </td>
                                <td class="p-2 align-middle whitespace-nowrap">{{ book.title }}</td>
                                <td class="p-2 align-middle whitespace-nowrap">{{ book.author }}</td>
                                <td class="p-2 align-middle whitespace-nowrap">{{ book.category?.name }}</td>
                                <td class="p-2 align-middle whitespace-nowrap">{{ book.publishedYear }}</td>
                                <td class="p-2 align-middle whitespace-nowrap">
                                    <div class="flex items-center gap-2">
                                        <button
                                            class="cursor-pointer inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 bg-blue-700 text-primary-foreground shadow-xs hover:bg-blue-700/90 h-8 rounded-md gap-1.5 px-3">Modifier</button>
                                        <button
                                            class="cursor-pointer inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 bg-destructive text-primary-foreground shadow-xs hover:bg-destructive/90 h-8 rounded-md gap-1.5 px-3">Supprimer</button>
                                    </div>
                                </td>
                            </tr>
                            } @empty {
                            <tr>
                                <td colspan="7" class="p-4 text-center">Aucun produit trouvé.</td>
                            </tr>
                            }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            @if (!loading()) {
            <div class="flex items-center justify-between px-2">
                <div class="text-muted-foreground flex-1 text-sm">
                    {{ pagedBooks()?.size }} sur {{ pagedBooks()?.totalElements }} ligne(s) sélectionnée(s).
                </div>

                @if (pagedBooks()?.content?.length) {
                <nav class="flex justify-center">
                    <ul data-slot="pagination-content" class="flex flex-row items-center gap-1">
                        <li>
                            <button
                                class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-9 py-2 has-[&gt;svg]:px-3 gap-1 px-2.5 sm:pl-2.5"
                                [disabled]="pagedBooks()?.first" aria-label="Go to previous page" type="button"
                                (click)="goToPage(1)">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round"
                                    class="lucide lucide-chevrons-left-icon lucide-chevrons-left">
                                    <path d="m11 17-5-5 5-5" />
                                    <path d="m18 17-5-5 5-5" />
                                </svg>
                            </button>
                        </li>
                        <li>
                            <button
                                class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-9 py-2 has-[&gt;svg]:px-3 gap-1 px-2.5"
                                [disabled]="pagedBooks()?.first" aria-label="Go to previous page" type="button"
                                (click)="goToPage(filters().page - 1)">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="lucide lucide-chevron-left">
                                    <path d="m15 18-6-6 6-6"></path>
                                </svg>
                            </button>
                        </li>

                        @for(p of pages(); track p) {
                        <li>
                            <button
                                class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 size-9"
                                [class.bg-accent]="p === pagedBooks()!.number + 1"
                                [class.text-accent-foreground]="p === pagedBooks()!.number + 1" (click)="goToPage(p)">
                                {{ p }}
                            </button>
                        </li>
                        }
                        <li>
                            <button
                                class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-9 py-2 has-[&gt;svg]:px-3 gap-1 px-2.5 sm:pr-2.5"
                                [disabled]="pagedBooks()?.last" (click)="goToPage(filters().page + 1)">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="lucide lucide-chevron-right">
                                    <path d="m9 18 6-6-6-6"></path>
                                </svg>
                            </button>
                        </li>
                        <li>
                            <button
                                class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-9 py-2 has-[&gt;svg]:px-3 gap-1 px-2.5 sm:pr-2.5"
                                [disabled]="pagedBooks()?.last" (click)="goToPage(pagedBooks()!.totalPages)">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round"
                                    class="lucide lucide-chevrons-right-icon lucide-chevrons-right">
                                    <path d="m6 17 5-5-5-5" />
                                    <path d="m13 17 5-5-5-5" />
                                </svg>
                            </button>
                        </li>
                    </ul>
                </nav>
                }
            </div>
            }
        </div>
    </div>
</admin-layout>